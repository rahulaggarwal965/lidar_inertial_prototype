#ifndef VISUALIZATION_H
#define VISUALIZATION_H

#include <array>
#include <opencv2/opencv.hpp>

static constexpr std::array<std::array<uint8_t, 3>, 215> DISTINCT_COLORS = {{
    {{156, 124, 123}}, {{250, 224, 159}}, {{0  , 104, 0  }},
    {{0  , 178, 231}}, {{112, 0  , 192}}, {{136, 30 , 26 }},
    {{213, 182, 90 }}, {{0  , 103, 0  }}, {{0  , 123, 159}},
    {{188, 93 , 255}}, {{234, 148, 145}}, {{211, 165, 0  }},
    {{0  , 103, 0  }}, {{0  , 89 , 117}}, {{99 , 72 , 114}},
    {{227, 82 , 74 }}, {{114, 92 , 0  }}, {{0  , 102, 0  }},
    {{0  , 129, 190}}, {{96 , 52 , 118}}, {{255, 19 , 0  }},
    {{154, 131, 0  }}, {{0  , 101, 0  }}, {{0  , 86 , 133}},
    {{170, 107, 193}}, {{165, 103, 95 }}, {{75 , 72 , 39 }},
    {{0  , 103, 0  }}, {{99 , 137, 157}}, {{145, 51 , 169}},
    {{130, 63 , 52 }}, {{148, 146, 118}}, {{0  , 100, 0  }},
    {{0  , 164, 255}}, {{195, 160, 199}}, {{203, 179, 176}},
    {{202, 188, 0  }}, {{0  , 99 , 0  }}, {{150, 216, 255}},
    {{222, 43 , 229}}, {{255, 195, 185}}, {{140, 134, 60 }},
    {{0  , 93 , 0  }}, {{65 , 85 , 98 }}, {{254, 190, 255}},
    {{255, 151, 132}}, {{216, 215, 165}}, {{0  , 87 , 0  }},
    {{0  , 98 , 173}}, {{255, 120, 255}}, {{255, 107, 74 }},
    {{108, 109, 64 }}, {{0  , 85 , 0  }}, {{122, 194, 255}},
    {{148, 105, 145}}, {{172, 51 , 20 }}, {{144, 152, 0  }},
    {{0  , 87 , 0  }}, {{0  , 130, 255}}, {{182, 0  , 164}},
    {{200, 104, 82 }}, {{71 , 74 , 0  }}, {{0  , 84 , 0  }},
    {{141, 175, 207}}, {{214, 103, 198}}, {{218, 157, 136}},
    {{201, 224, 52 }}, {{164, 246, 167}}, {{205, 228, 255}},
    {{160, 46 , 136}}, {{146, 74 , 46 }}, {{97 , 114, 2  }},
    {{0  , 232, 60 }}, {{60 , 84 , 114}}, {{243, 27 , 177}},
    {{255, 160, 122}}, {{199, 223, 115}}, {{0  , 153, 67 }},
    {{0  , 90 , 219}}, {{189, 164, 180}}, {{237, 74 , 0  }},
    {{141, 168, 73 }}, {{0  , 252, 131}}, {{144, 184, 255}},
    {{192, 101, 159}}, {{88 , 66 , 56 }}, {{134, 205, 0  }},
    {{119, 218, 169}}, {{140, 145, 153}}, {{255, 205, 237}},
    {{147, 111, 94 }}, {{93 , 147, 0  }}, {{93 , 157, 126}},
    {{222, 227, 236}}, {{196, 0  , 121}}, {{204, 104, 54 }},
    {{132, 151, 100}}, {{130, 166, 148}}, {{36 , 68 , 133}},
    {{142, 70 , 111}}, {{255, 149, 84 }}, {{209, 236, 168}},
    {{183, 221, 202}}, {{0  , 55 , 191}}, {{116, 85 , 103}},
    {{255, 209, 180}}, {{212, 212, 212}}, {{32 , 121, 80 }},
    {{98 , 129, 210}}, {{255, 113, 191}}, {{114, 54 , 14 }},
    {{177, 188, 166}}, {{0  , 84 , 46 }}, {{96 , 104, 148}},
    {{255, 0  , 136}}, {{255, 106, 0  }}, {{56 , 77 , 39 }},
    {{18 , 211, 136}}, {{205, 212, 255}}, {{162, 6  , 85 }},
    {{159, 66 , 0  }}, {{136, 254, 45 }}, {{0  , 172, 125}},
    {{44 , 60 , 158}}, {{188, 127, 154}}, {{216, 159, 117}},
    {{173, 246, 116}}, {{99 , 109, 106}}, {{148, 155, 202}},
    {{199, 0  , 82 }}, {{131, 83 , 45 }}, {{79 , 116, 63 }},
    {{150, 160, 158}}, {{43 , 63 , 255}}, {{255, 0  , 91 }},
    {{200, 182, 167}}, {{102, 158, 90 }}, {{0  , 254, 200}},
    {{124, 133, 251}}, {{191, 81 , 121}}, {{132, 116, 102}},
    {{80 , 99 , 78 }}, {{59 , 88 , 82 }}, {{105, 105, 123}},
    {{105, 56 , 71 }}, {{255, 156, 61 }}, {{152, 196, 147}},
    {{0  , 151, 130}}, {{170, 168, 255}}, {{239, 142, 172}},
    {{201, 107, 14 }}, {{102, 207, 97 }}, {{2  , 80 , 70 }},
    {{183, 183, 203}}, {{168, 0  , 46 }}, {{159, 126, 89 }},
    {{0  , 177, 0  }}, {{0  , 219, 192}}, {{95 , 84 , 160}},
    {{255, 104, 148}}, {{234, 208, 175}}, {{0  , 170, 0  }},
    {{151, 226, 221}}, {{125, 98 , 255}}, {{89 , 80 , 82 }},
    {{247, 188, 104}}, {{0  , 163, 0  }}, {{0  , 122, 117}},
    {{110, 89 , 199}}, {{228, 207, 213}}, {{136, 83 , 0  }},
    {{0  , 160, 0  }}, {{0  , 177, 178}}, {{140, 122, 184}},
    {{255, 190, 204}}, {{164, 125, 61 }}, {{0  , 158, 0  }},
    {{118, 166, 166}}, {{85 , 45 , 158}}, {{134, 31 , 50 }},
    {{113, 91 , 53 }}, {{0  , 155, 0  }}, {{0  , 241, 255}},
    {{217, 194, 255}}, {{180, 113, 124}}, {{235, 155, 0  }},
    {{0  , 155, 0  }}, {{0  , 109, 121}}, {{183, 133, 255}},
    {{255, 23 , 50 }}, {{180, 119, 0  }}, {{0  , 149, 0  }},
    {{0  , 165, 191}}, {{76 , 67 , 86 }}, {{146, 72 , 79 }},
    {{86 , 82 , 74 }}, {{0  , 146, 0  }}, {{0  , 219, 255}},
    {{140, 126, 158}}, {{255, 109, 121}}, {{231, 226, 217}},
    {{0  , 106, 0  }}, {{153, 239, 255}}, {{222, 206, 241}},
    {{109, 73 , 75 }}, {{96 , 65 , 0  }}, {{0  , 107, 0  }},
    {{33 , 77 , 86 }}, {{214, 164, 255}}, {{186, 26 , 32 }},
    {{190, 169, 117}}, {{0  , 107, 0  }}, {{175, 220, 231}},
    {{147, 0  , 255}}, {{178, 71 , 76 }}
}};

static cv::Mat visualize_labels(const cv::Mat& labels) {
    cv::Mat im = cv::Mat::zeros(labels.size(), CV_8UC3);
    for (int r = 0; r < labels.rows; r++) {
        for (int c = 0; c < labels.cols; c++) {
            const int label = labels.at<int>(r, c);
            if (label > 0) {
                const auto &col = DISTINCT_COLORS[label % DISTINCT_COLORS.size()];
                im.at<cv::Vec3b>(r, c) = {col[0], col[1], col[2]};
            }
        }
    }
    return im;
}

#endif
